# VM到期管理系统 - 用户手册

## 系统概述

VM到期管理系统是一个用于跟踪和管理虚拟机到期时间的Web应用程序。系统支持多项目管理、自动到期提醒、批量操作和详细的操作审计。

### 主要功能

- **VM记录管理**：创建、编辑、删除VM记录
- **项目管理**：组织VM资源，分配用户权限
- **到期监控**：自动检测即将到期的VM并发送邮件提醒
- **批量操作**：批量更新VM到期时间
- **权限控制**：基于角色和项目的访问控制
- **操作审计**：记录所有系统操作历史

## 用户角色

### 管理员 (Admin)
- 访问所有系统功能
- 管理所有项目和VM记录
- 查看操作审计日志
- 管理用户和项目分配

### 普通用户 (User)
- 只能访问被分配的项目
- 查看和管理分配项目下的VM记录
- 无法访问审计日志和用户管理

## 登录和认证

### 首次登录

1. 访问系统URL
2. 点击"登录"按钮
3. 输入用户名和密码
4. 系统验证后自动跳转到仪表板

### 会话管理

- 会话在一定时间后自动过期
- 过期后需要重新登录
- 可以手动登出以确保安全

## 仪表板

登录后进入系统仪表板，显示：

- **系统概览**：VM总数、即将到期数量等统计信息
- **快速操作**：常用功能的快捷入口
- **最近活动**：最近的系统操作记录
- **到期提醒**：即将到期的VM列表

## VM记录管理

### 查看VM列表

1. 点击导航栏中的"VM管理"
2. 系统显示当前用户权限范围内的所有VM记录
3. 列表包含以下信息：
   - VM名称/域名
   - 邮箱地址
   - 内网IP地址
   - 所属项目
   - 当前到期时间
   - 状态（正常/即将到期/已过期）

### 筛选和搜索

使用页面顶部的筛选器：

- **项目筛选**：按项目名称筛选
- **到期时间**：按到期时间范围筛选
- **状态筛选**：按VM状态筛选
- **关键词搜索**：搜索VM名称、邮箱等信息

### 创建新VM记录

1. 点击"添加VM"按钮
2. 填写必需信息：
   - **邮箱地址**：VM负责人邮箱
   - **VM账户**：VM登录账户名
   - **内网IP**：VM内网IP地址
   - **VM域名**：VM访问域名
   - **所属项目**：选择项目（管理员可选择任意项目）
   - **到期时间**：设置初始到期时间
3. 点击"保存"创建记录

### 编辑VM记录

1. 在VM列表中点击要编辑的记录
2. 点击"编辑"按钮
3. 修改需要更新的字段
4. 点击"保存"确认修改

### 删除VM记录

1. 在VM详情页面点击"删除"按钮
2. 确认删除操作
3. 记录将被永久删除（仅管理员可执行）

## 批量操作

### 批量更新到期时间

1. 在VM列表页面选择需要更新的VM记录
2. 点击"批量操作"按钮
3. 选择"更新到期时间"
4. 设置新的到期时间
5. 确认操作

### 批量续期

1. 选择需要续期的VM记录
2. 点击"批量续期"
3. 系统自动计算新的到期时间（默认延长3个月）
4. 确认续期操作

## 项目管理

### 查看项目列表

1. 点击导航栏中的"项目管理"
2. 查看所有项目信息：
   - 项目名称
   - 项目描述
   - VM数量
   - 创建时间

### 创建新项目（仅管理员）

1. 点击"创建项目"按钮
2. 填写项目信息：
   - **项目名称**：唯一的项目标识
   - **项目描述**：项目详细说明
3. 点击"保存"创建项目

### 编辑项目信息（仅管理员）

1. 点击项目名称进入详情页
2. 点击"编辑"按钮
3. 修改项目信息
4. 保存更改

### 用户项目分配（仅管理员）

1. 在项目详情页面点击"管理用户"
2. 选择要分配的用户
3. 点击"分配"确认
4. 用户将获得该项目的访问权限

## 到期管理和通知

### 自动到期检查

系统每天自动检查即将到期的VM：
- 检查时间：每天上午9点
- 提醒时间：到期前7天
- 通知方式：邮件通知

### 邮件通知内容

到期提醒邮件包含：
- VM详细信息（域名、IP、账户等）
- 当前到期时间
- 建议的续期操作
- 系统访问链接

### 手动续期

收到到期提醒后：
1. 登录系统
2. 找到对应的VM记录
3. 点击"续期"按钮
4. 确认新的到期时间
5. 保存更改

## 操作审计（仅管理员）

### 查看审计日志

1. 点击导航栏中的"审计日志"
2. 查看所有系统操作记录：
   - 操作时间
   - 操作用户
   - 操作类型
   - 影响的记录
   - 具体变更内容

### 筛选审计日志

使用筛选器查找特定操作：
- **时间范围**：按操作时间筛选
- **操作类型**：按操作类型筛选（创建、更新、删除等）
- **操作用户**：按执行用户筛选
- **实体类型**：按操作对象类型筛选

## 数据导出

### 导出VM数据

1. 在VM列表页面点击"导出"按钮
2. 选择导出格式（CSV/Excel）
3. 选择要导出的字段
4. 下载导出文件

### 导出审计日志（仅管理员）

1. 在审计日志页面点击"导出"
2. 设置时间范围
3. 选择导出格式
4. 下载审计报告

## 常见问题

### Q: 忘记密码怎么办？
A: 请联系系统管理员重置密码。

### Q: 为什么看不到某些VM记录？
A: 普通用户只能查看被分配项目下的VM记录。如需访问其他项目，请联系管理员。

### Q: 如何修改邮件通知设置？
A: 邮件通知设置由系统管理员统一配置，个人无法修改。

### Q: 批量操作失败怎么办？
A: 检查是否有足够的权限，确认选择的记录状态正常。如问题持续，请联系管理员。

### Q: 如何查看VM的历史变更？
A: 在VM详情页面可以查看该记录的变更历史。管理员可以在审计日志中查看详细的操作记录。

## 最佳实践

### 数据管理

- 定期检查和更新VM信息
- 及时处理到期提醒
- 保持项目分配的准确性

### 安全建议

- 定期更改密码
- 及时登出系统
- 不要共享账户信息

### 操作建议

- 批量操作前先小范围测试
- 重要操作前确认数据准确性
- 定期导出数据作为备份

## 技术支持

如遇到技术问题：

1. 检查网络连接
2. 刷新页面重试
3. 清除浏览器缓存
4. 联系系统管理员

**联系方式**：请通过内部渠道联系IT支持团队

---

**版本**：1.0.0  
**更新时间**：2024年1月4日